** I tried to fix as much as I can, but can't say how far I could go
** I hope spaghetti codes are okay for beginners :)